<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Graveyard ‚Äî Owen Bahen (Deluxe)</title>
<style>
  :root{
    --bg-dark:#07080b;
    --bg-mid:#0e1116;
    --stone:#2f2f2f;
    --accent:#b75b5b;
    --muted:#dcdcdc;
    --fog: rgba(255,255,255,0.03);
  }
  *{box-sizing:border-box;}
  html,body{height:100%; margin:0; padding:0; font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; color:var(--muted);}
  body{background: linear-gradient(180deg,var(--bg-dark) 0%, var(--bg-mid) 70%); overflow:hidden;}

  header{position:relative; z-index:900; padding:18px 20px; text-align:center; background: linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0.12)); border-bottom:1px solid rgba(255,255,255,0.03);}
  header h1{margin:0; font-size:1.4rem; color:#ffdede; letter-spacing:1px;}
  header p{margin:6px 0 0 0; font-size:0.9rem; color:#cfcfcf; opacity:0.95;}

  #stage{position:relative; width:100%; height:calc(100vh - 120px); overflow:hidden; background: radial-gradient(1200px 600px at 10% 6%, rgba(255,255,255,0.02), transparent 8%), linear-gradient(180deg,#0a0a0f 0%, #111217 60%);}
  .fog{position:absolute; left:-20%; right:-20%; top:-10%; bottom:-10%; pointer-events:none; z-index:80; opacity:0.22;}
  .fog div{position:absolute; width:40%; height:46%; background: linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.06), rgba(255,255,255,0.01)); filter:blur(18px); animation: drift linear infinite;}
  .fog div:nth-child(1){left:0%; top:10%; animation-duration:52s; animation-delay:0s;}
  .fog div:nth-child(2){left:28%; top:12%; animation-duration:70s; animation-delay:10s;}
  .fog div:nth-child(3){left:60%; top:0%; animation-duration:62s; animation-delay:5s;}
  @keyframes drift { from{transform:translateX(-8%)} to{transform:translateX(8%)} }

  #flash{position:absolute; inset:0; background:white; opacity:0; pointer-events:none; z-index:950;}

  .hud{position:absolute; left:16px; top:16px; z-index:900; display:flex; gap:12px; flex-direction:column;}
  .card{background:rgba(255,255,255,0.03); padding:10px 14px; border-radius:10px; border:1px solid rgba(255,255,255,0.03); backdrop-filter: blur(6px);}
  .card h3{margin:0 0 6px 0; font-size:0.95rem; color:#ffdcdc;}
  #score{font-size:1.2rem; font-weight:700;}
  #best{font-size:0.9rem; color:#f0dcdc; margin-top:6px;}

  .top-buttons{position:absolute; right:16px; top:16px; z-index:900; display:flex; gap:8px;}
  .btn{background:rgba(255,255,255,0.04); padding:8px 10px; border-radius:8px; color:var(--muted); border:1px solid rgba(255,255,255,0.03); cursor:pointer;}
  .btn.primary{background:linear-gradient(180deg,#6b2c2c,#a04444); color:white; border:none;}
  .btn.hidden{display:none;}

  #gravestone{position:absolute; left:50%; transform:translateX(-50%); bottom:26px; width:360px; min-height:160px; background:linear-gradient(180deg,var(--stone), #1f1f1f); border-radius:26px 26px 12px 12px; border:3px solid rgba(0,0,0,0.5); box-shadow: 0 12px 40px rgba(0,0,0,0.75), inset 0 -8px 24px rgba(255,255,255,0.02); z-index:410; padding:18px; text-align:center;}
  #gravestone h2{margin:0;color:#ffdede; font-size:1.05rem;}
  #gravestone .years{font-weight:700; margin-top:6px; color:#f0dcdc;}
  #gravestone .epitaph{margin-top:10px; font-size:0.88rem; color:#e0d9d9; line-height:1.28;}
  .crack{position:absolute; left:50%; top:4px; width:2px; height:0; background:linear-gradient(#333,#111); opacity:0.18; transform-origin:top; border-radius:2px;}
  .crack.c1{transform:translateX(-46px) rotate(-18deg);}
  .crack.c2{transform:translateX(0px) rotate(0deg);}
  .crack.c3{transform:translateX(46px) rotate(18deg);}
  .crack.show{height:86px; opacity:0.7;}
  #scroll{display:none; margin-top:12px; background: rgba(0,0,0,0.6); padding:10px; border-radius:8px; border:1px solid rgba(255,255,255,0.03); color:#ffd;font-size:0.92rem;}

  .item{position:absolute; font-size:36px; cursor:pointer; user-select:none; z-index:300; transform-origin:center; transition: transform 120ms;}
  .bone{font-size:34px;}
  .skull{font-size:42px;}
  .zombie{font-size:46px;}
  .bat{font-size:40px;}
  .vamp{font-size:48px;}
  .ghost{font-size:46px; opacity:0.95;}

  #boss{position:absolute; left:50%; top:-30%; font-size:88px; transform:translateX(-50%); opacity:0; z-index:680; pointer-events:auto; text-shadow:0 8px 30px rgba(255,255,255,0.08); transition: transform 0.35s, opacity 0.35s;}
  #boss.active{top:8%; opacity:1; transform:translateX(-50%) scale(1.02);}
  #boss.hit{transform:translateX(-50%) scale(0.93);}

  .candle{position:absolute; bottom:12px; font-size:22px; opacity:0; transition:opacity 0.8s; z-index:420;}
  .candle.show{opacity:1;}

  .crow{position:absolute; font-size:28px; z-index:520; opacity:0.95;}

  #milestone-list{margin-top:8px; font-size:0.86rem; color:#ffd;}

  #owen-rise{position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.85)); z-index:999; color:#ffdede; font-size:28px; flex-direction:column; opacity:0; pointer-events:none; transition:opacity 0.6s;}
  #owen-rise.show{opacity:1; pointer-events:auto;}
  #owen-rise .big{font-size:120px; margin-bottom:10px; text-shadow:0 18px 60px rgba(0,0,0,0.7);}

  .floatText{position:absolute; font-weight:700; color:#ffdede; pointer-events:none; z-index:980; text-shadow:0 6px 18px rgba(0,0,0,0.7);}

  @media (max-width:720px){
    #gravestone{width:280px;padding:12px;}
    .item{font-size:28px;}
    .zombie{font-size:38px;}
    #boss{font-size:60px;}
    .candle{font-size:18px;}
    .hud{left:8px; top:8px;}
    .top-buttons{right:8px; top:8px;}
  }
</style>
</head>
<body>

<header>
  <h1>‚ò†Ô∏è The Graveyard ‚Äî Owen Bahen ‚ò†Ô∏è</h1>
  <p>"3 Century Man" ‚Äî RIP 1997 ‚Äì 2100 ‚Äî Born interesting. Died interesting.</p>
</header>

<div id="stage" aria-live="polite">
  <div class="fog" aria-hidden="true"><div></div><div></div><div></div></div>
  <div id="flash" aria-hidden="true"></div>

  <!-- HUD -->
  <div class="hud" role="region" aria-label="Game HUD">
    <div class="card">
      <h3>Score</h3>
      <div id="score">0</div>
      <div id="best">Best: 0</div>
    </div>
    <div class="card">
      <h3>Milestones</h3>
      <div style="font-size:0.9rem">10 ‚Ä¢ 25 ‚Ä¢ 50 ‚Ä¢ 100</div>
      <div id="milestone-list"></div>
    </div>
  </div>

  <div class="top-buttons">
    <button class="btn" id="infoBtn">‚ÑπÔ∏è Info</button>
    <button class="btn hidden" id="mainBtn">üè† Main Page</button>
    <button class="btn" id="muteBtn">üîä</button>
  </div>

  <!-- gravestone -->
  <div id="gravestone" role="button" title="Click the gravestone">
    <h2>Owen Bahen</h2>
    <div class="years">1997 ‚Äî 2100</div>
    <div class="epitaph">
      "3 Century Man"<br/>
      Born on the side of the road ‚Äî Local newspaper Day 1.<br/>
      Ended with the same local fame.
    </div>
    <div id="scroll">A secret scroll: Owen walked the line between ordinary & extraordinary. Click the stone.</div>
    <div class="crack c1" id="crack1"></div>
    <div class="crack c2" id="crack2"></div>
    <div class="crack c3" id="crack3"></div>
  </div>

  <div id="boss" aria-hidden="true">üëª</div>

  <div class="candle" id="c1" style="left:calc(50% - 230px)">üïØÔ∏è</div>
  <div class="candle" id="c2" style="left:calc(50% - 10px)">üïØÔ∏è</div>
  <div class="candle" id="c3" style="left:calc(50% + 210px)">üïØÔ∏è</div>

  <!-- owen rise overlay -->
  <div id="owen-rise" role="dialog" aria-hidden="true">
    <div class="big">üßü‚Äç‚ôÇÔ∏è</div>
    <div>Owen Rises ‚Äî The Graveyard Trembles</div>
    <button class="btn primary" id="closeRise" style="margin-top:18px">Return to Grave</button>
  </div>
</div>

<!-- Info Modal -->
<div id="infoModal" style="position:fixed; inset:6% 6%; background:rgba(8,8,8,0.94); padding:18px; z-index:1100; border-radius:12px; display:none; color:var(--muted)">
  <h2 style="color:#ffdede;margin-top:0">How to Play</h2>
  <ul>
    <li>ü¶¥ <strong>Bone</strong> ‚Äî 1 pt (available from 1+)</li>
    <li>üíÄ <strong>Skull</strong> ‚Äî 3 pts (available from 3+; spawns at 0.5√ó rate)</li>
    <li>üßü <strong>Zombie</strong> ‚Äî 5 pts (available from 10+)</li>
    <li>ü¶á <strong>Bat</strong> ‚Äî 10 pts (available from 30+)</li>
    <li>üßõ <strong>Vampire</strong> ‚Äî 25 pts (rare; appears after first bat)</li>
    <li>üëª <strong>Ghost</strong> ‚Äî 1 pt (each ghost can be clicked up to 10 times)</li>
  </ul>
  <p>Reach milestones (10 / 25 / 50 / 100) to increase spawn rates cumulatively. Milestones can be claimed with a name (saved locally).</p>
  <p>Controls: <kbd>c</kbd> to clear items, <kbd>t</kbd> to toggle practice mode.</p>
  <div style="text-align:center; margin-top:12px">
    <button class="btn" id="closeInfo">Close</button>
  </div>
</div>

<script>
/* Full game JS merged with visual layout */

/* Elements */
const stage = document.getElementById('stage');
const scoreEl = document.getElementById('score');
const bestEl = document.getElementById('best');
const infoBtn = document.getElementById('infoBtn');
const infoModal = document.getElementById('infoModal');
const closeInfo = document.getElementById('closeInfo');
const mainBtn = document.getElementById('mainBtn');
const muteBtn = document.getElementById('muteBtn');
const gravestone = document.getElementById('gravestone');
const crack1 = document.getElementById('crack1');
const crack2 = document.getElementById('crack2');
const crack3 = document.getElementById('crack3');
const scroll = document.getElementById('scroll');
const boss = document.getElementById('boss');
const c1 = document.getElementById('c1'), c2=document.getElementById('c2'), c3=document.getElementById('c3');
const owenRise = document.getElementById('owen-rise'); 
const closeRise = document.getElementById('closeRise');
const flash = document.getElementById('flash');
const milestoneList = document.getElementById('milestone-list');

let score = 0;
let best = Number(localStorage.getItem('grave_best') || 0);
bestEl.textContent = best;

const CONFIG = {
  spawnBaseMs: 1200,
  screenCapBase: 6,
  ghostMaxClicks: 10,
  milestones: [10,25,50,100],
  milestoneSpawnIncreases: {10:1.25,25:1.25,50:1.25,100:2}
};

const EMOJIS = [
  {id:'bone', sym:'ü¶¥', pts:1, min:1, spawnWeight:60, movement:'side'},
  {id:'skull', sym:'üíÄ', pts:3, min:3, spawnWeight:25, movement:'side', weightMul:0.5},
  {id:'zombie', sym:'üßü', pts:5, min:10, spawnWeight:8, movement:'shuffle'},
  {id:'bat', sym:'ü¶á', pts:10, min:30, spawnWeight:5, movement:'side'},
  {id:'vamp', sym:'üßõ', pts:25, min:50, spawnWeight:1, movement:'hover'},
  {id:'ghost', sym:'üëª', pts:1, min:0, spawnWeight:4, movement:'float', clicks: CONFIG.ghostMaxClicks}
];

let activeItems=[];
let milestoneReached={};

/* spawn item */
function spawnItem(){
  const available = EMOJIS.filter(e=>score>=e.min);
  if(!available.length) return;
  const totalWeight = available.reduce((a,b)=>a+(b.weightMul?b.spawnWeight*b.weightMul:b.spawnWeight),0);
  let rnd = Math.random()*totalWeight;
  let chosen;
  for(const e of available){
    const w = e.weightMul? e.spawnWeight*e.weightMul:e.spawnWeight;
    if(rnd<w){chosen=e; break;} rnd-=w;
  }
  if(!chosen) chosen = available[0];

  const el = document.createElement('div');
  el.classList.add('item', chosen.id);
  el.textContent = chosen.sym;
  el.style.left = `${Math.random()*75+10}%`;
  el.style.top = `-${Math.random()*12+6}%`;
  el.dataset.pts=chosen.pts;
  el.dataset.id = chosen.id;
  if(chosen.clicks) el.dataset.clicks = chosen.clicks;
  stage.appendChild(el);
  activeItems.push(el);

  animateItem(el, chosen.movement);
}

/* animate item */
function animateItem(el, movement){
  let top = parseFloat(el.style.top);
  let left = parseFloat(el.style.left);
  let dir = 1;
  const interval = setInterval(()=>{
    if(!el.parentElement){clearInterval(interval); return;}
    if(movement==='side'){left+=0.16*dir; el.style.left=left+'%'; if(left>90||left<5) dir*=-1;}
    else if(movement==='shuffle'){top+=0.2; left+=Math.sin(top/6)*0.25; el.style.top=top+'%'; el.style.left=left+'%';}
    else if(movement==='hover'){top+=Math.sin(Date.now()/500)*0.08; el.style.top=(top+0.1)+'%';}
    else if(movement==='float'){top+=0.12; el.style.top=top+'%';}
    if(top>100) {el.remove(); clearInterval(interval);}
  },24);

  el.addEventListener('click',()=>{
    const pts=parseInt(el.dataset.pts);
    score+=pts;
    scoreEl.textContent=score;
    flashScreen();
    createFloat(el, `+${pts}`);
    if(el.dataset.clicks){
      el.dataset.clicks--;
      if(el.dataset.clicks<=0) el.remove();
    } else el.remove();

    checkMilestones();
  });
}

/* floating text */
function createFloat(el,text){
  const f = document.createElement('div');
  f.className='floatText';
  f.style.left = el.offsetLeft + 'px';
  f.style.top = el.offsetTop + 'px';
  f.textContent=text;
  stage.appendChild(f);
  setTimeout(()=>f.remove(),900);
}

/* flash screen */
function flashScreen(){
  flash.style.opacity=0.22;
  setTimeout(()=>flash.style.opacity=0,80);
}

/* spawn loop */
setInterval(spawnItem, CONFIG.spawnBaseMs);

/* milestone */
function checkMilestones(){
  CONFIG.milestones.forEach(m=>{
    if(score>=m&&!milestoneReached[m]){
      milestoneReached[m]=true;
      milestoneList.textContent+=`‚≠ê ${m} pts `;
      // increase spawn rate
    }
  });
}

/* gravestone click */
gravestone.addEventListener('click',()=>{
  scroll.style.display=scroll.style.display==='block'?'none':'block';
  crack1.classList.add('show');
  crack2.classList.add('show');
  crack3.classList.add('show');
  c1.classList.add('show'); c2.classList.add('show'); c3.classList.add('show');
});

/* boss rise trigger */
function triggerOwenRise(){
  owenRise.classList.add('show');
  boss.classList.add('active');
}

closeRise.addEventListener('click',()=>{
  owenRise.classList.remove('show');
  boss.classList.remove('active');
});

/* info modal */
infoBtn.addEventListener('click',()=>infoModal.style.display='block');
closeInfo.addEventListener('click',()=>infoModal.style.display='none');

/* keyboard shortcuts */
document.addEventListener('keydown',(e)=>{
  if(e.key==='c'){activeItems.forEach(it=>it.remove()); activeItems=[];}
  if(e.key==='t'){alert('Practice mode toggled!');}
});

</script>
</body>
</html>
